import{r as o,j as t}from"./app-8b83436b.js";const Q=({locationData:e,mapKey:E})=>{var z,j,G,N;const[R,_]=o.useState(!1);o.useEffect(()=>{_(!0)},[]);const[x,y]=o.useState(null),[B,Z]=o.useState(14),k=o.useRef(null),n=o.useRef([]),P=window.GoogleMapApi,[S,L]=o.useState(!1),[V,f]=o.useState(!1),O=(d,s,p)=>{const r=new window.google.maps.Marker({position:d,map:window.googleMap,icon:{url:s,labelOrigin:new window.google.maps.Point(20,-20)},label:{text:p,color:"#C70E20",fontWeight:"bold",fontSize:"14px"}});return n.current.push(r),r},v=()=>{var i,g,m,w,M,c,C,F,I,$;if(!window.googleMap){console.error("Map is not initialized");return}n.current.forEach(h=>h.setMap(null)),n.current=[];const d=new window.google.maps.LatLngBounds,s=(h,A,T,U)=>{if(h!=null&&A!=null){const W=new window.google.maps.LatLng(h,A),q=O(W,T,U);d.extend(q.getPosition())}},p=(i=e==null?void 0:e.location)!=null&&i.address?`${e.location.address.street_address||""} 
          ${e.location.address.city||""} 
          ${e.location.address.state||""}, 
          ${e.location.address.zip_code||""}`:void 0;(m=(g=e==null?void 0:e.location)==null?void 0:g.address)!=null&&m.latitude&&((M=(w=e==null?void 0:e.location)==null?void 0:w.address)!=null&&M.longitude)&&s(e.location.address.latitude,e.location.address.longitude,"http://maps.google.com/mapfiles/ms/icons/green-dot.png",e.location.name||p),(C=(c=e==null?void 0:e.parking)==null?void 0:c.address)!=null&&C.latitude&&((I=(F=e==null?void 0:e.parking)==null?void 0:F.address)!=null&&I.longitude)&&s(e.parking.address.latitude,e.parking.address.longitude,"http://maps.google.com/mapfiles/ms/icons/blue-dot.png",e.parking.name||"Parking Area");let r=(($=e.hospital)==null?void 0:$.address)||e.hospital;r||(r=e.hospital);const u=r==null?void 0:r.latitude,l=r==null?void 0:r.longitude;u&&l&&s(u,l,"http://maps.google.com/mapfiles/ms/icons/red-dot.png",e.hospital.name||"Hospital"),d.isEmpty()||(window.googleMap.fitBounds(d),window.google.maps.event.addListenerOnce(window.googleMap,"bounds_changed",function(){this.getZoom()>14&&this.setZoom(14)}))},H=()=>{if(window.googleMapsScriptLoaded){L(!0);return}if(!V){f(!0);const d="google-maps-script";if(document.getElementById(d))L(!0),f(!1);else{const s=document.createElement("script");s.id=d,s.src=`https://maps.googleapis.com/maps/api/js?key=${P}&callback=initGoogleMap`,s.async=!0,s.defer=!0,s.onload=()=>{window.googleMapsScriptLoaded=!0,L(!0),f(!1)},s.onerror=p=>{console.error("Error loading Google Maps script",p),y("Failed to load the Google Maps script."),f(!1)},document.body.appendChild(s)}}},b=()=>{var d,s,p,r,u,l;try{let i,g;typeof((s=(d=e==null?void 0:e.location)==null?void 0:d.address)==null?void 0:s.latitude)<"u"&&typeof((r=(p=e==null?void 0:e.location)==null?void 0:p.address)==null?void 0:r.longitude)<"u"?(i=parseFloat(e.location.address.latitude),g=parseFloat(e.location.address.longitude)):typeof((u=e==null?void 0:e.location)==null?void 0:u.latitude)<"u"&&typeof((l=e==null?void 0:e.location)==null?void 0:l.longitude)<"u"?(i=parseFloat(e.location.latitude),g=parseFloat(e.location.longitude)):(i=33.5387,g=-112.1863);const m=!isNaN(i)&&i>=-90&&i<=90,w=!isNaN(g)&&g>=-180&&g<=180;if(!m||!w)throw new Error("Invalid latitude or longitude");const M={lat:i,lng:g};window.googleMap?(n.current.forEach(c=>c.setMap(null)),n.current=[]):(window.googleMap=new window.google.maps.Map(k.current,{center:M,zoom:B,streetViewControl:!1,mapTypeControl:!1,zoomControl:!1,fullscreenControl:!0}),window.googleMap.addListener("zoom_changed",()=>{Z(window.googleMap.getZoom())})),v()}catch(i){console.error("Google Map initialization error:",i),y("Failed to initialize the Google Map.")}};return o.useEffect(()=>{window.initGoogleMap=b},[]),o.useEffect(()=>{var d,s,p,r;!window.googleMap&&((s=(d=e==null?void 0:e.location)==null?void 0:d.address)!=null&&s.latitude)&&((r=(p=e==null?void 0:e.location)==null?void 0:p.address)!=null&&r.longitude)&&H()},[e,E]),o.useEffect(()=>{S&&e&&b()},[S,e,E]),o.useEffect(()=>{window.googleMap&&e&&v()},[e,E]),x?t.jsx("div",{className:"error-message",children:x}):!e||!(e!=null&&e.location)||!((j=(z=e==null?void 0:e.location)==null?void 0:z.address)!=null&&j.latitude)||!((N=(G=e==null?void 0:e.location)==null?void 0:G.address)!=null&&N.longitude)?t.jsxs("div",{className:"bg-slate-50 flex flex-col gap-8 text-center text-slate-400 justify-center items-center h-full w-full",children:[t.jsx("img",{src:"/images/svg_images/location.svg",alt:"",className:"saturate-0 opacity-[.15] w-[10rem]"}),"Map unavailable. ",t.jsx("br",{})," Enter location data to view the map."]}):t.jsx("div",{className:`fade-in ${R?"opacity-1":"opacity-0"}`,ref:k,style:{width:"100%",height:"100%"}})};export{Q as default};

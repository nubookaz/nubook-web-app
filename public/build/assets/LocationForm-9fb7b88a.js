import{R as v,j as e,n as A,r}from"./app-d6201cb1.js";import{l as N}from"./lodash-d45ede16.js";import{S}from"./SecondaryButton-ec37e17e.js";import{P as b}from"./PrimaryButton-a6b04e33.js";import R from"./Accordion-6eb3061f.js";import{I as B}from"./IconButton-733615f2.js";import{r as L}from"./index-d825d59e.js";import"./index.es-4ddfc134.js";import"./index-cbb8f8c7.js";import"./AccordionContent-45fe2601.js";import"./Input-3545e92a.js";import"./Tooltip-72ad1b91.js";import"./toPropertyKey-0671445a.js";import"./useSlot-958e930c.js";import"./useIsFocusVisible-38d1530f.js";import"./useControlled-565a38ff.js";import"./useEventCallback-4bbe510b.js";import"./useEnhancedEffect-8ef057d9.js";import"./Popper-e501f2f6.js";import"./Address-3d862fb7.js";import"./Hospitals-517bb359.js";class at extends v.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,n){console.error("Uncaught error:",t,n)}render(){return this.state.hasError?e.jsx("h1",{children:"Something went wrong."}):this.props.children}}const et=({project:i,callSheet:t,onClose:n,mode:s="create"})=>{const{updateCurrentCallSheet:l}=A(),[f,h]=r.useState(!1);r.useEffect(()=>{h(!0)},[]);const[c,d]=r.useState({location:{address:{}},parking:{address:{}},hospital:{address:{}}}),[x,g]=r.useState({location:"",parking:"",hospital:""}),w=r.useCallback(N.debounce(o=>d(o),0),[]),j=o=>{w(o)},y=o=>{g(o)},C=r.useRef(),[M,p]=r.useState(Math.random()),[m,I]=r.useState(!1),u=()=>{I(!m)},D=async()=>{const o={location:c.location,parking:c.parking,hospital:c.hospital,accordionInfo:x,id:s!=="create"?t.id:void 0};try{let a;s==="create"?a=await axios.post(route("projects.callSheets.save.locations",{id:i.id,callSheetId:t.id}),o):a=await axios.put(route("projects.callSheets.update.locations",{id:i.id,callSheetId:t.callSheetId}),o),a.status===200&&(l(a.data),n(),u())}catch(a){console.error("Error submitting location data:",a)}p(Math.random())},E=async()=>{try{const o=route("projects.callSheets.delete.location",{id:i.id,callSheetId:t.callSheetId,locationId:t.location.id}),a=await axios.delete(o);a.status===200&&(console.log(a),l(a.data.updatedCallSheet),u(),n())}catch(o){console.error("Error deleting the location:",o)}};return r.useEffect(()=>{p(Math.random())},[c.location]),r.useEffect(()=>{if(s!=="create"&&t){const o=t.location?{...t.location}:{},a=t.parking_location?{...t.parking_location.location}:{},k=t.hospital_location?{...t.hospital_location}:{};d({location:o,parking:a,hospital:k})}},[t,s]),e.jsx("div",{className:"flex flex-row w-[80rem] h-[55rem]",children:e.jsxs("div",{className:`fade-in w-full flex flex-col gap-4 justify-between p-10 ${f?"opacity-1":"opacity-0"}`,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-2xl text-slate-500",children:"Location Details"}),e.jsx("p",{className:"text-slate-400",children:"Add filming location details here"})]}),e.jsx(R,{ref:C,locationType:t.locationType,callSheet:t,onAccordionDataChange:j,onAccordionInfoChange:y,resetSignal:m}),e.jsxs("div",{className:`flex flex-row mx-auto gap-6 w-full ${s=="create"?"max-w-[25rem]":"max-w-[35rem]"}`,children:[s!="create"?e.jsx(B,{icon:L,onClick:E,buttonClass:"text-xl my-auto text-rose-500 group-hover:text-white",className:"cursor-pointer max-w-[5rem] duration-500 transition-all bg-slate-100 w-full rounded-lg group hover:bg-rose-500"}):null,e.jsx(S,{onClick:n,className:"w-full h-full p-0",children:"Cancel"}),e.jsx(b,{onClick:D,className:"w-full h-full  p-0",children:s=="create"?"Add Location":"Update Location"})]})]})})};export{et as default};

import{w as M,r,j as a}from"./app-8b83436b.js";const F=({videoProjectDetails:o,setPosterImage:p,setSelectionError:A,posterImagePreview:d,handlePosterImageChange:j})=>{const{createMedia:v}=M(),[I,m]=r.useState(d),[_,h]=r.useState(!1),[c,g]=r.useState(!1),[N,C]=r.useState(0),[u,f]=r.useState(0),[x,y]=r.useState(""),E=10;r.useEffect(()=>{const s=setInterval(()=>{C(e=>(e+1)%E)},5e3);return()=>clearInterval(s)},[]),r.useEffect(()=>{let s=null;return c?s=setInterval(()=>{f(e=>e<100?e+1:(clearInterval(s),100))},100):f(0),()=>s&&clearInterval(s)},[c]);const S=async s=>{const e=s.target.files[0];if(e){const t=URL.createObjectURL(e);m(t),j(t);const n=new FormData;n.append("media",e),o.id&&n.append("project_id",o.id);const i=new Image;i.onload=async()=>{n.append("dimensions",JSON.stringify({width:i.width,height:i.height})),n.append("media_type",e.type),n.append("size",e.size),n.append("ai_generated",!1);try{p({poster:e,dimensions:{width:i.width,height:i.height},media_type:e.type,size:e.size,ai_generated:!1,media_path:t})}catch(l){console.error("Error while uploading the image: ",l)}},i.src=t}},w=()=>{document.getElementById("fileInput").click()},b=r.useCallback(async s=>{g(!0);try{const e=await fetch("/api/media/generateAiImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:s})});if(e.ok){const t=await e.json(),n={project_id:o.id,media_path:t.url,media_type:t.type,size:t.size,dimensions:JSON.stringify({width:t.width,height:t.height}),ai_generated:!0};m(`/storage/${t.media_path}`),p({poster:t.media_path,dimensions:{width:t.width,height:t.height},media_type:t.type,size:t.size,ai_generated:!0,media_path:`/storage/${t.media_path}`})}else throw new Error("Failed to generate AI poster")}catch(e){console.error("Error generating AI poster:",e)}finally{g(!1)}},[v,m,p,o]),k=r.useCallback(()=>{const{project_name:s,primaryGenre:e,secondaryGenre:t,viewerRating:n,projectDescription:i}=o;if(!s||!e||!n||!i||t===void 0){y("Please fill out the entire form before generating the AI image.");return}y("");let l=`Create an image for '${s}', a ${e} ${t} movie rated ${n}. Description: ${i}.`;l.length>1e3&&(l=l.substring(0,1e3)),b(l)},[b,o]),z=()=>{h(!0)},O=()=>{h(!1)};r.useEffect(()=>{d&&m(d)},[d]);const $=`/images/movie_posters/movie_poster_${N+1}.jpg`;return a.jsxs("div",{className:"relative w-full",children:[a.jsx("input",{type:"file",id:"fileInput",accept:".png, .jpg, .jpeg",onChange:S,style:{display:"none"}}),a.jsx("label",{className:"block text-gray-700 text-sm text-center w-full font-bold mb-2",htmlFor:"projectDescription",children:"Project Poster"}),a.jsxs("div",{className:"mt-4 mb-6 h-[26rem] w-[18rem] shadow-md mx-auto relative cursor-pointer",onMouseOver:z,onMouseOut:O,onClick:w,children:[_&&a.jsxs("div",{className:"absolute text-center m-auto h-full duration-500 transition-all w-full",children:[a.jsx("div",{className:"w-full h-full bg-slate-700/75 absolute z-30"}),a.jsx("p",{className:"absolute z-40 text-white top-[50%] -translate-y-2/4 px-6",children:"Click here to upload or drag and drop an image"})]}),c&&a.jsx("div",{className:"absolute inset-0 bg-gray-500 bg-opacity-50 flex justify-center items-center",children:a.jsxs("div",{children:[u,"% Loading... "]})}),a.jsx("img",{src:I||$,alt:"Preview",className:"w-full h-auto h-full  object-cover rounded-md  border-4 border-white"})]}),x&&a.jsx("p",{className:"text-red-500 mt-2 text-center",children:x}),a.jsxs("div",{className:"items-center justify-center w-full flex flex-row gap-4",children:[a.jsx("button",{onClick:w,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded",children:"Upload Image"}),a.jsx("button",{onClick:k,disabled:c,className:"mt-2 ml-2 px-4 py-2 bg-green-500 text-white rounded",children:c?`${u}% Generating...`:"Generate AI Image"})]})]})};export{F as default};

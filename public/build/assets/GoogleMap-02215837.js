import{r as i,j as f}from"./app-659a3aa2.js";const Q=({locationData:e,mapKey:E})=>{var z,G,j,N;console.log("GoogleMap 1",e);const[R,_]=i.useState(!1);i.useEffect(()=>{_(!0)},[]);const[x,y]=i.useState(null),[B,Z]=i.useState(14),k=i.useRef(null),n=i.useRef([]),P=window.GoogleMapApi,[S,L]=i.useState(!1),[V,t]=i.useState(!1),O=(d,s,g)=>{const r=new window.google.maps.Marker({position:d,map:window.googleMap,icon:{url:s,labelOrigin:new window.google.maps.Point(20,-20)},label:{text:g,color:"#C70E20",fontWeight:"bold",fontSize:"14px"}});return n.current.push(r),r},v=()=>{var o,p,m,w,M,c,C,F,I,$;if(!window.googleMap){console.error("Map is not initialized");return}n.current.forEach(h=>h.setMap(null)),n.current=[];const d=new window.google.maps.LatLngBounds,s=(h,A,T,U)=>{if(h!=null&&A!=null){const W=new window.google.maps.LatLng(h,A),q=O(W,T,U);d.extend(q.getPosition())}},g=(o=e==null?void 0:e.location)!=null&&o.address?`${e.location.address.street_address||""} 
          ${e.location.address.city||""} 
          ${e.location.address.state||""}, 
          ${e.location.address.zip_code||""}`:void 0;(m=(p=e==null?void 0:e.location)==null?void 0:p.address)!=null&&m.latitude&&((M=(w=e==null?void 0:e.location)==null?void 0:w.address)!=null&&M.longitude)&&s(e.location.address.latitude,e.location.address.longitude,"http://maps.google.com/mapfiles/ms/icons/green-dot.png",e.location.name||g),(C=(c=e==null?void 0:e.parking)==null?void 0:c.address)!=null&&C.latitude&&((I=(F=e==null?void 0:e.parking)==null?void 0:F.address)!=null&&I.longitude)&&s(e.parking.address.latitude,e.parking.address.longitude,"http://maps.google.com/mapfiles/ms/icons/blue-dot.png",e.parking.name||"Parking Area");let r=(($=e.hospital)==null?void 0:$.address)||e.hospital;r||(r=e.hospital);const l=r==null?void 0:r.latitude,u=r==null?void 0:r.longitude;l&&u&&s(l,u,"http://maps.google.com/mapfiles/ms/icons/red-dot.png",e.hospital.name||"Hospital"),d.isEmpty()||(window.googleMap.fitBounds(d),window.google.maps.event.addListenerOnce(window.googleMap,"bounds_changed",function(){this.getZoom()>14&&this.setZoom(14)}))},H=()=>{if(window.googleMapsScriptLoaded){L(!0);return}if(!V){t(!0);const d="google-maps-script";if(document.getElementById(d))L(!0),t(!1);else{const s=document.createElement("script");s.id=d,s.src=`https://maps.googleapis.com/maps/api/js?key=${P}&callback=initGoogleMap`,s.async=!0,s.defer=!0,s.onload=()=>{window.googleMapsScriptLoaded=!0,L(!0),t(!1)},s.onerror=g=>{console.error("Error loading Google Maps script",g),y("Failed to load the Google Maps script."),t(!1)},document.body.appendChild(s)}}},b=()=>{var d,s,g,r,l,u;try{let o,p;typeof((s=(d=e==null?void 0:e.location)==null?void 0:d.address)==null?void 0:s.latitude)<"u"&&typeof((r=(g=e==null?void 0:e.location)==null?void 0:g.address)==null?void 0:r.longitude)<"u"?(o=parseFloat(e.location.address.latitude),p=parseFloat(e.location.address.longitude)):typeof((l=e==null?void 0:e.location)==null?void 0:l.latitude)<"u"&&typeof((u=e==null?void 0:e.location)==null?void 0:u.longitude)<"u"?(o=parseFloat(e.location.latitude),p=parseFloat(e.location.longitude)):(o=33.5387,p=-112.1863);const m=!isNaN(o)&&o>=-90&&o<=90,w=!isNaN(p)&&p>=-180&&p<=180;if(!m||!w)throw new Error("Invalid latitude or longitude");const M={lat:o,lng:p};window.googleMap?(n.current.forEach(c=>c.setMap(null)),n.current=[]):(window.googleMap=new window.google.maps.Map(k.current,{center:M,zoom:B,streetViewControl:!1,mapTypeControl:!1,zoomControl:!1,fullscreenControl:!0}),window.googleMap.addListener("zoom_changed",()=>{Z(window.googleMap.getZoom())})),v()}catch(o){console.error("Google Map initialization error:",o),y("Failed to initialize the Google Map.")}};return i.useEffect(()=>{window.initGoogleMap=b},[]),i.useEffect(()=>{var d,s,g,r;!window.googleMap&&((s=(d=e==null?void 0:e.location)==null?void 0:d.address)!=null&&s.latitude)&&((r=(g=e==null?void 0:e.location)==null?void 0:g.address)!=null&&r.longitude)&&H()},[e,E]),i.useEffect(()=>{S&&e&&b()},[S,e,E]),i.useEffect(()=>{window.googleMap&&e&&v()},[e,E]),x?f.jsx("div",{className:"error-message",children:x}):!e||!(e!=null&&e.location)||!((G=(z=e==null?void 0:e.location)==null?void 0:z.address)!=null&&G.latitude)||!((N=(j=e==null?void 0:e.location)==null?void 0:j.address)!=null&&N.longitude)?f.jsxs("div",{className:"bg-slate-50 flex flex-col gap-8 text-center text-slate-400 justify-center items-center h-full w-full",children:[f.jsx("img",{src:"/images/svg_images/location.svg",alt:"",className:"saturate-0 opacity-[.15] w-[10rem]"}),"Map unavailable. ",f.jsx("br",{})," Enter location data to view the map."]}):f.jsx("div",{className:`fade-in ${R?"opacity-1":"opacity-0"}`,ref:k,style:{width:"100%",height:"100%"}})};export{Q as default};

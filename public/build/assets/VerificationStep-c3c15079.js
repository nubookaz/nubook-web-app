import{u as S,r as s,j as e}from"./app-659a3aa2.js";import{P as h}from"./PrimaryButton-bfc388c8.js";function k({error:o,setCurrentStep:v,handleError:c,handleResponse:l}){const{userData:r}=S(),[d,y]=s.useState(""),[i,u]=s.useState(null),[g,f]=s.useState(!1),[j,n]=s.useState(!1),[_,w]=s.useState(null),[C,m]=s.useState(!1),[R,T]=s.useState(null),x=async()=>{m(!0);try{const t=await axios.post(route("verification.resendCode"),{},{headers:{Accept:"application/json"}});l(t,()=>{t.data.success&&(T(t.data.newCodeExpiresAt),w(new Date),n(!1))})}catch(t){c(t,"Error during verification")}finally{m(!1)}},E=async()=>{try{const t=await axios.post(route("verification.verifyCode"),{verificationCode:d},{headers:{Accept:"application.json"}});l(t,()=>{t.data.success&&v("personalInfo")})}catch(t){c(t,"Error during verification")}};return s.useEffect(()=>{if(!r||!r.code_expires_at)return;f(!0);const t=new Date(r.code_expires_at+"Z").getTime();if(Date.now()>=t){n(!0);return}n(!1),u({}),f(!0);const p=setInterval(()=>{const N=Date.now(),a=t-N;a>0?u({minutes:Math.floor(a/1e3/60%60),seconds:Math.floor(a/1e3%60)}):(clearInterval(p),n(!0))},1e3);return()=>clearInterval(p)},[r.code_expires_at]),e.jsxs("div",{className:"flex flex-row gap-8 h-full",children:[e.jsx("div",{className:"w-1/2 h-full flex flex-col justify-center",children:e.jsx("img",{className:"mx-auto max-w-[15rem]",src:"./images/svg_images/undraw_mailbox.svg",alt:""})}),e.jsxs("div",{className:"w-1/2 my-auto h-auto justify-center flex flex-col gap-6",children:[e.jsx("h2",{className:"text-2xl text-slate-500",children:"Verify Your Email"}),e.jsx("p",{children:"To ensure the security of your account, please check your email inbox for a verification code. To complete the verification process, paste the code in the provided field. Thank you for confirming your email address and enhancing your account's security."}),j?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-center w-full p-6 bg-slate-50 flex-none",children:"Your verification code has expired."}),C?e.jsx("p",{children:"Loading..."}):e.jsx(h,{className:"h-full grow",onClick:x,children:"Resend Verification Code"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",id:"verification_code",name:"code",className:"text-center",placeholder:"One Time Code",value:d,onChange:t=>y(t.target.value),required:!0}),o&&e.jsx("div",{style:{color:"red"},children:o}),g?e.jsxs("div",{className:"text-center secondary-color mb-4",children:["Time Remaining to Verify: ",i.minutes,":",i.seconds<10?`0${i.seconds}`:i.seconds]}):null,e.jsx(h,{onClick:E,children:"Verify Code"}),e.jsx("p",{className:"h-full grow text-center text-sm cursor-pointer",onClick:x,children:"Resend Verification Code"})]})]})]})}export{k as default};

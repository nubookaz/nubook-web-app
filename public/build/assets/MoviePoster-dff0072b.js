import{r as s,y as K,j as e}from"./app-659a3aa2.js";import{u as Q}from"./index-b4698f05.js";import{S as P}from"./SecondaryButton-f759061d.js";import{F as N}from"./index.es-6780b8c7.js";import{ar as V,as as X}from"./index-84704c9c.js";import{M as Y}from"./Modal-cab82769.js";import{B as Z}from"./Box-d2e1cd8f.js";import{C as ee}from"./CircularProgress-af137ff7.js";import"./index-9e3aa4c7.js";import"./useSlot-d43794ee.js";import"./toPropertyKey-61b1ecea.js";import"./extendSxProp-9e510b8c.js";function ve({data:a,header:A="true",posterPackage:u,disableRandomShuffler:te=!1,saveToDatabase:f=!1}){const[se,_]=s.useState({video_type:"",project_name:"",project_description:"",primary_genre:"",secondary_genre:"",viewer_rating:""});s.useEffect(()=>{_(a)},[a]);const[c,g]=s.useState({url:a.movie_poster&&a.movie_poster.url?a.movie_poster.url:"",dimensions:"",fileSize:"",file:"",aiGenerated:!1}),[R,re]=s.useState(!1),[m,x]=s.useState(0),[i,k]=s.useState([]),[h,E]=s.useState(!1),[M,oe]=s.useState(0),[z,D]=s.useState(!1),[j,U]=s.useState({currentCount:0,limit:0}),[F,ae]=s.useState(!1),[G,ne]=s.useState(!1),[v,L]=s.useState("");s.useState("");const B=async()=>{try{const r=await axios.get(route("ai-content.info"));U(r.data)}catch(r){console.error("Error fetching AI content info:",r)}};s.useEffect(()=>{B()},[]);const p=s.useCallback(r=>{const t=r[0];if(!t.type.match("image/jpeg")&&!t.type.match("image/png")){alert("Only JPG and PNG files are allowed");return}const o=25*1024*1024;if(t.size>o){alert("File is too large. Maximum size is 25MB.");return}const n=new FileReader;n.onload=l=>{const d=new Image;d.onload=async()=>{const C=URL.createObjectURL(t);await q(C,!1),g({url:URL.createObjectURL(t),dimensions:`${d.width}x${d.height}`,fileSize:t.size,file:t,aiGenerated:""}),await S(C)},d.src=l.target.result},n.readAsDataURL(t),E(!0)},[]),{getRootProps:O,getInputProps:$,isDragActive:J}=Q({onDrop:p,noClick:!0}),y=s.useRef(null),T=s.useCallback(r=>{const t=r.target.files;p(t)},[p]),w=()=>{y.current.click()};s.useEffect(()=>{b()},[]);const b=()=>{const r=Array.from({length:10},(t,o)=>o+1);r.sort(()=>Math.random()-.5),k(r),x(0)};s.useEffect(()=>{if(i.length===0||h)return;if(m>=i.length){b();return}const r=setInterval(()=>{x(t=>(t+1)%i.length)},1e4);return()=>clearInterval(r)},[m,i,h]);const I=i[m],W=`/images/movie_posters/movie_poster_${I}.jpg`,q=async(r,t)=>{if(f)await S(c.file,r);else{const o={...c,url:r,aiGenerated:t};g(o),u&&typeof u=="function"&&u(o)}},S=async(r,t)=>{if(console.log("Saving image with URL:",t),!f){console.log("Saving to database is disabled");return}console.log(t);const o=new File([r],"upload.jpg",{type:"image/jpeg"}),n=new FormData;n.append("image",o),n.append("image_url",t),n.append("project_id",a.id);try{const l=await K.post(route("projects.save.poster",{id:a.id}),n,{headers:{"Content-Type":"multipart/form-data"}});l&&l.status===200?console.log("Image saved to server"):console.error("Error or unexpected response saving image to server:",l)}catch(l){console.error("Exception saving image to server:",l)}},H=({message:r,onClose:t})=>e.jsxs("div",{className:"error-modal left-[50%] top-[50%] -translate-y-2/4 -translate-x-2/4	duration-500 absolute bg-white p-8 z-50 shadow-xl rounded-md text-center flex flex-col gap-6",children:[e.jsx("p",{className:"text-rose-500 font-bold text-xl",children:r}),e.jsx(P,{onClick:t,children:"Close"})]});return e.jsxs("div",{className:"relative",children:[e.jsxs(Y,{show:z,onClose:D,dialogPanelClass:"!max-w-[40rem] p-[2rem]",showCloseButton:"true",children:[G?e.jsx(ProjectImagePreview,{data:image}):null,F?e.jsxs("div",{className:"text-center my-8",children:[e.jsx("h2",{children:"AI generated content"}),e.jsx("p",{className:"text-lg",children:"AI generated content uses a lot of resources so currently the max is set to 5 daily per user regardless of the amount of projects."}),e.jsxs("p",{className:"text-md text-center font-bold text-rose-500 my-6",children:["AI Generated Content: ",j.currentCount,"/",j.limit]}),e.jsx("span",{className:"text-xs italic text-center",children:"Note: AI generated images aren't always accurate so use at your own discretion!"})]}):null]}),e.jsxs("div",{className:"flex flex-col gap-2 h-full w-full rounded-md ",children:[v&&e.jsx(H,{message:v,onClose:()=>L(null)}),A?e.jsx("h4",{className:"text-slate-400 text-center text-md font-semibold",children:"Project Image"}):null,e.jsx("input",{ref:y,type:"file",style:{display:"none"},accept:"image/jpeg, image/png",onChange:T}),e.jsxs("div",{...O(),className:"w-full h-[26rem] my-2 relative rounded-md overflow-hidden max-w-[17rem] mx-auto",style:{backgroundImage:c.url?`url(${c.url})`:I!==void 0?`url(${W})`:"",backgroundPosition:"center center",backgroundSize:"cover",border:J?"2px dashed #ccc":"none"},children:[e.jsx("input",{...$()}),R&&e.jsx("div",{className:"rounded-md flex justify-center items-center h-full bg-slate-500/75 backdrop-blur-sm",children:e.jsx(Z,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:e.jsx(ee,{determinate:!0,value:M})})}),e.jsxs("div",{className:"absolute inset-0 flex flex-col gap-8 items-center justify-center bg-black bg-opacity-[65%] opacity-0 hover:opacity-100 transition-opacity duration-500",children:[e.jsxs("div",{className:"flex flex-row gap-4 ",children:[e.jsx("div",{className:"cursor-pointer text-sm p-4 border-2 border-slate-300 group hover:bg-slate-300 rounded-full duration-500 ease-in-out",children:e.jsx(N,{className:"w-[1.2rem] h-[1.2rem] group-hover:text-slate-500 justify-center flex text-slate-300  ",icon:V})}),e.jsx("div",{className:"cursor-pointer text-sm p-4 border-2 bg-transparent border-slate-300 hover:bg-slate-300 group rounded-full duration-500 ease-in-out",onClick:w,children:e.jsx(N,{className:"w-[1.2rem] h-[1.2rem] justify-center flex text-slate-300 group-hover:text-slate-500 ",icon:X})})]}),e.jsx("p",{className:"text-white text-center px-4",children:"Drag and drop your own image here or click to upload."})]})]}),e.jsx("div",{className:"flex flex-row gap-2 justify-center",children:e.jsx(P,{className:"!bg-slate-200 !text-slate-400 text-xs !hover:bg-slate-500",onClick:w,children:"Upload an Image"})})]})]})}export{ve as default};

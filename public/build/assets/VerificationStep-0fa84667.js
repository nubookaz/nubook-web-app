import{u as _,r as s,j as e}from"./app-eefe6961.js";import{P as p}from"./PrimaryButton-7fd1b638.js";function D({error:n,setCurrentStep:h,handleError:c,handleResponse:l}){const{user:r,fetchUserData:d}=_();s.useEffect(()=>{d()},[]);const[u,v]=s.useState(""),[i,f]=s.useState(null),[y,m]=s.useState(!1),[j,a]=s.useState(!1),[E,g]=s.useState(null),w=async()=>{try{const t=await axios.post(route("verification.resendCode"),{},{headers:{Accept:"application/json"}});l(t,async()=>{t.data.success&&(g(new Date),a(!1),await d())})}catch(t){c(t,"Error during verification")}},T=async()=>{try{const t=await axios.post(route("verification.verifyCode"),{verificationCode:u},{headers:{Accept:"application.json"}});l(t,()=>{t.data.success&&h("personalInfo")})}catch(t){c(t,"Error during verification")}};return s.useEffect(()=>{if(!r||!r.code_expires_at)return;m(!0);const t=new Date(r.code_expires_at+"Z").getTime();if(Date.now()>=t){a(!0);return}a(!1),f({}),m(!0);const x=setInterval(()=>{const C=Date.now(),o=t-C;o>0?f({minutes:Math.floor(o/1e3/60%60),seconds:Math.floor(o/1e3%60)}):(clearInterval(x),a(!0))},1e3);return()=>clearInterval(x)},[r.code_expires_at]),e.jsxs("div",{className:"flex flex-row gap-8 h-full",children:[e.jsx("div",{className:"w-1/2 h-full flex flex-col justify-center",children:e.jsx("img",{className:"mx-auto max-w-[15rem]",src:"./images/svg_images/undraw_mailbox.svg",alt:""})}),e.jsxs("div",{className:"w-1/2 my-auto h-full justify-center flex flex-col gap-6",children:[e.jsx("h2",{children:"Verify Your Email"}),e.jsx("p",{children:"To ensure the security of your account, please check your email inbox for a verification code. To complete the verification process, paste the code in the provided field. Thank you for confirming your email address and enhancing your account's security."}),j?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-center w-full p-6 bg-slate-50 flex-none",children:"Your verification code has expired."}),e.jsx(p,{className:"h-full grow",onClick:w,children:"Resend Verification Code"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",id:"verification_code",name:"code",placeholder:"One Time Code",value:u,onChange:t=>v(t.target.value),required:!0}),n&&e.jsx("div",{style:{color:"red"},children:n}),y?e.jsxs("div",{className:"text-center secondary-color mb-4",children:["Time Remaining to Verify: ",i.minutes,":",i.seconds<10?`0${i.seconds}`:i.seconds]}):null,e.jsx(p,{onClick:T,children:"Verify Code"})]})]})]})}export{D as default};

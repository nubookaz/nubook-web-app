import{R as v,j as e,n as A,r}from"./app-e454a32c.js";import{l as N}from"./lodash-ff26d80e.js";import{S}from"./SecondaryButton-a12dea95.js";import{P as b}from"./PrimaryButton-40aba8a0.js";import R from"./Accordion-595a44e0.js";import{I as B}from"./IconButton-c8b21cd2.js";import{u as L}from"./index-54708238.js";import"./index.es-372425f6.js";import"./index-af94e81f.js";import"./AccordionContent-d0f04001.js";import"./Input-3887f8bc.js";import"./Tooltip-be341731.js";import"./toPropertyKey-a22241f9.js";import"./useSlot-7faddf1c.js";import"./useIsFocusVisible-3e69e93a.js";import"./useEventCallback-49b41c49.js";import"./useEnhancedEffect-43c2324b.js";import"./Popper-834fe13e.js";import"./Address-3dede1de.js";import"./Hospitals-175ed20a.js";class ot extends v.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,n){console.error("Uncaught error:",t,n)}render(){return this.state.hasError?e.jsx("h1",{children:"Something went wrong."}):this.props.children}}const at=({project:i,callSheet:t,onClose:n,mode:s="create"})=>{const{updateCurrentCallSheet:l}=A(),[f,h]=r.useState(!1);r.useEffect(()=>{h(!0)},[]);const[c,d]=r.useState({location:{address:{}},parking:{address:{}},hospital:{address:{}}}),[x,g]=r.useState({location:"",parking:"",hospital:""}),w=r.useCallback(N.debounce(o=>d(o),0),[]),j=o=>{w(o)},y=o=>{g(o)},C=r.useRef(),[M,p]=r.useState(Math.random()),[u,I]=r.useState(!1),m=()=>{I(!u)},D=async()=>{const o={location:c.location,parking:c.parking,hospital:c.hospital,accordionInfo:x,id:s!=="create"?t.id:void 0};try{let a;s==="create"?a=await axios.post(route("projects.callSheets.save.locations",{id:i.id,callSheetId:t.id}),o):a=await axios.put(route("projects.callSheets.update.locations",{id:i.id,callSheetId:t.callSheetId}),o),a.status===200&&(l(a.data),n(),m())}catch(a){console.error("Error submitting location data:",a)}p(Math.random())},E=async()=>{try{const o=route("projects.callSheets.delete.location",{id:i.id,callSheetId:t.callSheetId,locationId:t.location.id}),a=await axios.delete(o);a.status===200&&(console.log(a),l(a.data.updatedCallSheet),m(),n())}catch(o){console.error("Error deleting the location:",o)}};return r.useEffect(()=>{p(Math.random())},[c.location]),r.useEffect(()=>{if(s!=="create"&&t){const o=t.location?{...t.location}:{},a=t.parking_location?{...t.parking_location.location}:{},k=t.hospital_location?{...t.hospital_location}:{};d({location:o,parking:a,hospital:k})}},[t,s]),e.jsx("div",{className:"flex flex-row w-[80rem] h-[55rem]",children:e.jsxs("div",{className:`fade-in w-full flex flex-col gap-4 justify-between p-10 ${f?"opacity-1":"opacity-0"}`,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-2xl text-slate-500",children:"Location Details"}),e.jsx("p",{className:"text-slate-400",children:"Add filming location details here"})]}),e.jsx(R,{ref:C,locationType:t.locationType,callSheet:t,onAccordionDataChange:j,onAccordionInfoChange:y,resetSignal:u}),e.jsxs("div",{className:`flex flex-row mx-auto gap-6 w-full ${s=="create"?"max-w-[25rem]":"max-w-[35rem]"}`,children:[s!="create"?e.jsx(B,{icon:L,onClick:E,buttonClass:"text-xl my-auto text-rose-500 group-hover:text-white",className:"cursor-pointer max-w-[5rem] duration-500 transition-all bg-slate-100 w-full rounded-lg group hover:bg-rose-500"}):null,e.jsx(S,{onClick:n,className:"w-full h-full p-0",children:"Cancel"}),e.jsx(b,{onClick:D,className:"w-full h-full  p-0",children:s=="create"?"Add Location":"Update Location"})]})]})})};export{at as default};

import{n as D,l as P,r as d,j as a}from"./app-8b83436b.js";import A from"./Time-0bff5189.js";import k from"./Phone-63595ab8.js";import M from"./Email-6e29c9c3.js";import{I as q}from"./Input-77ff0868.js";import{S as $}from"./Select-33702378.js";import B from"./UserName-733c8280.js";import{P as H}from"./PrimaryButton-83478115.js";import{F as G}from"./index.es-ee268f83.js";import{t as O}from"./index-e6ab5b50.js";import{S as U}from"./SecondaryButton-ae44dfd5.js";import"./Tooltip-1f0ef08d.js";import"./toPropertyKey-39201a13.js";import"./useSlot-a2532144.js";import"./useIsFocusVisible-97f68d26.js";import"./useControlled-9031fbe1.js";import"./useEventCallback-96e4a742.js";import"./useEnhancedEffect-99238f73.js";import"./Popper-794acb7d.js";import"./index-3b70e7e7.js";const ce=({project:c,callSheet:n,recipient:t,roles:u,onClose:h})=>{const{addRecipientToCallSheet:C,removeRecipientFromCallSheet:S}=D(),{setSnackContent:x,setIsSnackOpen:v}=P(),p={first_name:"",middle_initial:"",last_name:"",email:"",tel:"",position:"",role:""},[l,i]=d.useState(p),[f,r]=d.useState({phone_number:!1,first_name:!1,middle_initial:!1,last_name:!1});d.useEffect(()=>{if(t){const e=u.find(o=>o.name===t.user.pivot.role_name),s={first_name:t.user.first_name||"",middle_initial:t.user.middle_initial||"",last_name:t.user.last_name||"",email:t.user.email||"",tel:t.user.phone?t.user.phone.tel:"",position:t.user.pivot?t.user.pivot.position:"",role:e?e.id:""};i(s)}else i(p)},[t,u]);const[j,g]=d.useState("8:00 AM"),y=e=>{if(!e)return"8:00 AM";const[s,o]=e.split(":"),m=parseInt(s,10),E=m>=12?"PM":"AM";return`${m%12||12}:${o} ${E}`},_=e=>{const{name:s,value:o}=e.target;i(m=>({...m,[s]:o}))},b=e=>{i(s=>({...s,...e}))},w=e=>{i(s=>({...s,tel:e}))},N=e=>{i(s=>({...s,email:e}))},T=e=>{g(e)},F=async()=>{try{let e;t?e=route("projects.callSheets.update.recipient",{id:c.id,callSheetId:n.id,recipientId:t.user.id}):e=route("projects.callSheets.recipient",{id:c.id,callSheetId:n.id});const s={...l,call_time:j},o=await axios.post(e,s,{headers:{"Content-Type":"application/json"}});i(p),g("8:00 AM"),r({phone_number:!1}),setTimeout(()=>{x(t?"Receipient updated successfully!":"Receipient added successfully!"),v(!0)},600),h(),C(n.id,o.data)}catch(e){console.error("Error during save:",e.response||e.message)}},I=e=>{e.preventDefault(),F()},R=async()=>{if(!t||!window.confirm("Are you sure you want to remove this recipient from the call sheet?"))return;const s=t.user.id;try{const o=route("projects.callSheets.delete.recipient",{id:c.id,callSheetId:n.id,recipientId:t.user.id});await axios.delete(o),S(s),h()}catch(o){console.error("Error during deletion:",o.response||o.message)}};return a.jsxs("form",{onSubmit:I,className:"flex flex-col gap-4 px-8 py-8",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-slate-400 text-2xl",children:t?"Edit Recipient":"Add a Recipient to your call sheet"}),a.jsxs("p",{children:["Fill out the details below to ",t?"edit":"add"," a recipient."]})]}),a.jsx(B,{data:{first_name:l.first_name,middle_initial:l.middle_initial,last_name:l.last_name},onNameChange:b,emptyFields:f,setEmptyFields:r}),a.jsxs("div",{className:"flex flex-row gap-4 w-full",children:[a.jsx(M,{data:l.email,required:!0,onEmailChange:N,emptyFields:f,setEmptyFields:r}),a.jsx(k,{data:l.tel,onPhoneNumberChange:w,emptyFields:f,setEmptyFields:r})]}),a.jsxs("div",{className:"flex flex-row gap-4",children:[a.jsx($,{label:"Role",name:"role",value:l.role,onChange:_,required:!0,title:"Role",children:u.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))}),a.jsx(q,{label:"Position",name:"position",value:l.position,onChange:_,required:!0,title:"Position",placeholder:"Director, Grip, PA, etc"})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{htmlFor:"call_time",className:"text-gray-400 text-sm",children:"Call Time"}),a.jsx(A,{initialTime:y(t==null?void 0:t.user.pivot.call_time)||j,onTimeChange:T})]}),a.jsxs("div",{className:"flex flex-row gap-4 w-full mt-8 justify-center",children:[t&&a.jsx("button",{type:"button",className:"bg-slate-50 hover:bg-red-700 text-rose-200 hover:text-white duration-500 transition-all font-bold py-2 px-4 rounded",onClick:R,children:a.jsx(G,{icon:O})}),a.jsx(U,{onClick:h,children:"Cancel"}),a.jsx(H,{type:"submit",children:"Submit"})]})]})};export{ce as default};

import{r as o,j as e}from"./app-eefe6961.js";import{S as y}from"./SecondaryButton-70a47f80.js";import{F as b}from"./index.es-6f9cfa5f.js";import{z as Z,E as ee,U as te}from"./index-1074990b.js";import{M as re}from"./Modal-f577344b.js";import oe from"./ProjectImagePreview-17de09c6.js";import{B as se}from"./Box-5ac5becb.js";import{C as ae}from"./CircularProgress-5764a8a7.js";import"./index-d5199ec3.js";import"./ImageContainer-9a333d0e.js";import"./useSlot-a85726b4.js";import"./toPropertyKey-a23e7eac.js";import"./extendSxProp-d164df09.js";function ye({data:I,setEmptyFields:ne,header:O="true",onImageChange:P,isCustomImage:C,setIsCustomImage:p,setUploadedImage:N,setImageIsAIGenerated:B,onPosterSizeChange:k,disableRandomShuffler:f=!1}){const[d,R]=o.useState({video_type:"",project_name:"",project_description:"",primary_genre:"",secondary_genre:"",viewer_rating:"",movie_poster:""});o.useEffect(()=>{R(I)},[I]);const g=typeof d.movie_poster=="object"&&d.movie_poster!==null?d.movie_poster.url:d.movie_poster,x=f?"/images/movie_posters/coming_soon_poster.jpg":"/images/movie_posters/movie_poster_1.jpg",[m,u]=o.useState(g||x),[h,_]=o.useState(!1),[L,j]=o.useState(0),[c,z]=o.useState({currentCount:0,limit:0}),[A,v]=o.useState(""),[F,w]=o.useState(!1),[W,$]=o.useState(!1),[q,T]=o.useState(!1);o.useEffect(()=>{u(g||x)},[g,x]);const H=()=>{w(!0),$(!0)},J=()=>{w(!0),T(!0)},[E,M]=o.useState({backgroundImage:m});o.useEffect(()=>{if(C||f)return;const t=s=>{for(let n=s.length-1;n>0;n--){const G=Math.floor(Math.random()*(n+1));[s[n],s[G]]=[s[G],s[n]]}return s};let r=t(Array.from({length:10},(s,n)=>n+1)),a=0;const i=setInterval(()=>{u(`/images/movie_posters/movie_poster_${r[a]}.jpg`),a++,a>=r.length&&(r=t(r),a=0)},1e4);return()=>clearInterval(i)},[C,f]),o.useEffect(()=>{let t;return h&&(t=setInterval(()=>{j(r=>r>=100?100:r+10)},800)),()=>clearInterval(t)},[h]);const S=t=>{const r=t.target.files[0];if(r){const a=URL.createObjectURL(r),l=new Image;l.onload=()=>{const i={width:l.width,height:l.height};k(i),u(a),N(r),P(a),p(!0)},l.src=a}},K=t=>{t.preventDefault()},Q=t=>{t.preventDefault(),S(t)},U=()=>{document.getElementById("imageUpload").click()},V=async()=>{if(c.currentCount>=c.limit){alert("Daily limit for AI generated content reached.");return}_(!0);try{const t=await axios.post(route("chat.gpt.movie.poster"),{...d});if(t.data&&t.data.data&&t.data.data.length>0){const r=t.data.data[0].url,a=await axios.get(`/fetch-image?url=${encodeURIComponent(r)}`,{responseType:"blob"}),l=new Blob([a.data],{type:"image/png"}),i=URL.createObjectURL(l),s=new Image;s.onload=()=>{const n={width:s.width,height:s.height};k(n)},s.src=i,u(i),N(l),P(i),p(!0),M({...E,backgroundImage:i}),j(100),B(!0),await D()}else console.error("Invalid response format:",t.data),v("Invalid data received from the server.")}catch(t){console.error("Error generating poster content:",t);let r="Failed to generate poster. Please try again later.";if(t.response)switch(t.response.status){case 400:r="Bad request. Please check the input data.";break;case 500:r="Server error. Please try again later.";break;default:r="An unexpected error occurred."}v(r),M({...E,backgroundImage:m})}finally{_(!1),j(0)}p(!0)},D=async()=>{try{const t=await axios.get(route("ai-content.info"));z(t.data)}catch(t){console.error("Error fetching AI content info:",t)}};o.useEffect(()=>{D()},[]);const X=({message:t,onClose:r})=>e.jsxs("div",{className:"error-modal left-[50%] top-[50%] -translate-y-2/4 -translate-x-2/4	duration-500 absolute bg-white p-8 z-50 shadow-xl rounded-md text-center flex flex-col gap-6",children:[e.jsx("p",{className:"text-rose-500 font-bold text-xl",children:t}),e.jsx(y,{onClick:r,children:"Close"})]}),Y=async()=>{await V()};return e.jsxs("div",{className:"flex flex-col gap-2 h-full w-full rounded-md ",children:[e.jsxs(re,{show:F,onClose:w,dialogPanelClass:"!max-w-[40rem] p-[2rem]",showCloseButton:"true",children:[W?e.jsx(oe,{data:m}):null,q?e.jsxs("div",{className:"text-center my-8",children:[e.jsx("h2",{children:"AI generated content"}),e.jsx("p",{className:"text-lg",children:"AI generated content uses a lot of resources so currently the max is set to 5 daily per user regardless of the amount of projects."}),e.jsxs("p",{className:"text-md text-center font-bold text-rose-500 my-6",children:["AI Generated Content: ",c.currentCount,"/",c.limit]}),e.jsx("span",{className:"text-xs italic text-center",children:"Note: AI generated images aren't always accurate so use at your own discretion!"})]}):null]}),A&&e.jsx(X,{message:A,onClose:()=>v(null)}),O?e.jsx("h4",{className:"text-slate-400 text-center text-md font-semibold",children:"Project Image"}):null,e.jsx("p",{className:"text-sm text-center leading-4",children:"Click 'Generate Poster' to create an AI generated poster based on your project info or upload your own!"}),e.jsxs("p",{className:"flex flex-row gap-4 text-sm justify-center font-bold text-rose-500",children:["AI Generated Content: ",c.currentCount,"/",c.limit,e.jsx(b,{onClick:J,className:"cursor-pointer w-[1.2rem] h-[1.2rem] justify-center flex",icon:Z})]}),e.jsx("input",{type:"file",id:"imageUpload",style:{display:"none"},onChange:S,accept:"image/*"}),e.jsxs("div",{className:"w-full h-[26rem] my-2 relative rounded-md overflow-hidden max-w-[17rem] mx-auto",style:{backgroundImage:`url(${m})`,backgroundPosition:"center center",backgroundSize:"cover"},onDragOver:K,onDrop:Q,children:[h&&e.jsx("div",{className:"rounded-md flex justify-center items-center h-full bg-slate-500/75 backdrop-blur-sm",children:e.jsx(se,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:e.jsx(ae,{determinate:!0,value:L})})}),e.jsxs("div",{className:"absolute inset-0 flex flex-col gap-8 items-center justify-center bg-black bg-opacity-[65%] opacity-0 hover:opacity-100 transition-opacity duration-500",children:[e.jsxs("div",{className:"flex flex-row gap-4 ",children:[e.jsx("div",{onClick:H,className:"cursor-pointer text-sm p-4 border-2 border-slate-300 group hover:bg-slate-300 rounded-full duration-500 ease-in-out",children:e.jsx(b,{className:"w-[1.2rem] h-[1.2rem] group-hover:text-slate-500 justify-center flex text-slate-300  ",icon:ee})}),e.jsx("div",{onClick:U,className:"cursor-pointer text-sm p-4 border-2 bg-transparent border-slate-300 hover:bg-slate-300 group rounded-full duration-500 ease-in-out",children:e.jsx(b,{className:"w-[1.2rem] h-[1.2rem] justify-center flex text-slate-300 group-hover:text-slate-500 ",icon:te})})]}),e.jsx("p",{className:"text-white text-center px-4",children:'Drag and drop your own image here or click the "Generate AI Poster" to create one.'})]})]}),e.jsxs("div",{className:"flex flex-row gap-2 justify-center",children:[e.jsx(y,{className:"text-xs",onClick:Y,children:"Generate AI Poster"}),e.jsx(y,{className:"!bg-slate-200 !text-slate-400 text-xs",onClick:U,children:"Upload an Image"})]})]})}export{ye as default};
